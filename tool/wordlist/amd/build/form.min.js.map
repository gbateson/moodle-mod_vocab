{"version":3,"file":"form.min.js","sources":["../src/form.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * mod/vocab/tool/wordlist/amd/src/form.js\n *\n * @module     vocabtool_wordlist\n * @copyright  2023 Gordon Bateson (gordon.bateson@gmail.com)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      Moodle 3.11\n */\n\ndefine([], function(){\n\n    var JS = {};\n\n    JS.SELECTALL_SELECTOR = \"input[type=checkbox][name^='wordlist[0]']\";\n    JS.CHECKBOX_SELECTOR = \"input[type=checkbox][name^='wordlist']:not([name='wordlist[0]'])\";\n    JS.ACTION_SELECTOR = \"select[name='wordlist[wordlistaction]']\";\n    JS.BUTTON_SELECTOR = \"input[type=submit][name='wordlist[wordlistbutton]']\";\n\n    JS.add_event_listener = function(obj, evt, fn, useCapture) {\n        if (obj.addEventListener) {\n            obj.addEventListener(evt, fn, (useCapture || false));\n        } else if (obj.attachEvent) {\n            obj.attachEvent('on' + evt, fn);\n        }\n    };\n\n    /*\n     * initialize this AMD module\n     */\n    JS.init = function() {\n        JS.setup_selectall();\n        JS.setup_checkboxes();\n        JS.setup_wordlistaction();\n    };\n\n    /*\n     * Setup the selectall checkbox\n     */\n    JS.setup_selectall = function() {\n        // Activate \"Select all/none\" checkbox for the word list.\n        const selectall = document.querySelector(JS.SELECTALL_SELECTOR);\n        if (selectall) {\n            JS.set_selectall_wordtext(selectall);\n            JS.add_event_listener(selectall, 'click', JS.onclick_selectall);\n        }\n    };\n\n    /*\n     * Setup the text for the selectall checkbox.\n     */\n    JS.set_selectall_wordtext = function(selectall) {\n        const checked = selectall.checked;\n        const dataset = selectall.dataset;\n        const text = (checked ? dataset.deselectall : dataset.selectall);\n        const wordtext = selectall.closest(\"label\").querySelector(\".wordtext\");\n        if (wordtext) {\n            wordtext.innerHTML = text;\n        }\n    };\n\n    /*\n     * Setup the selectall checkbox\n     */\n    JS.onclick_selectall = function() {\n        const selectall = this;\n        JS.set_selectall_wordtext(selectall);\n        document.querySelectorAll(JS.CHECKBOX_SELECTOR).forEach(function(cb){\n            cb.checked = selectall.checked;\n        });\n        JS.set_wordlistaction();\n    };\n\n    /*\n     * Setup the single checkbox.\n     */\n    JS.setup_checkboxes = function() {\n        document.querySelectorAll(JS.CHECKBOX_SELECTOR).forEach(function(cb){\n            JS.add_event_listener(cb, 'click', JS.set_wordlistaction);\n        });\n    };\n\n    /*\n     * Setup the single checkbox.\n     */\n    JS.setup_wordlistaction = function() {\n        const wordlistaction = document.querySelector(JS.ACTION_SELECTOR);\n        if (wordlistaction) {\n            JS.add_event_listener(wordlistaction, 'change', JS.set_wordlistbutton);\n            JS.set_wordlistaction();\n        }\n    };\n\n    /*\n     * Disable or enable the \"with selected\" menu.\n     */\n    JS.set_wordlistaction = function() {\n        let count = 0;\n        document.querySelectorAll(JS.CHECKBOX_SELECTOR).forEach(function(cb){\n            if (cb.checked) {\n                count++;\n            }\n        });\n        const wordlistaction = document.querySelector(JS.ACTION_SELECTOR);\n        if (wordlistaction) {\n            if (count) {\n                wordlistaction.removeAttribute(\"disabled\");\n            } else {\n                wordlistaction.setAttribute(\"disabled\", \"disabled\");\n            }\n            JS.set_wordlistbutton();\n        }\n    };\n\n    /*\n     * Disable or enable the \"with selected\" menu.\n     */\n    JS.set_wordlistbutton = function() {\n        const wordlistaction = document.querySelector(JS.ACTION_SELECTOR);\n        const wordlistbutton = document.querySelector(JS.BUTTON_SELECTOR);\n        if (wordlistaction && wordlistbutton) {\n            if (wordlistaction.getAttribute(\"disabled\") || wordlistaction.selectedIndex < 1) {\n                wordlistbutton.setAttribute(\"disabled\", \"disabled\");\n            } else {\n                wordlistbutton.removeAttribute(\"disabled\");\n            }\n        }\n    };\n\n    return JS;\n});"],"names":["define","JS","obj","evt","fn","useCapture","addEventListener","attachEvent","setup_selectall","setup_checkboxes","setup_wordlistaction","selectall","document","querySelector","SELECTALL_SELECTOR","set_selectall_wordtext","add_event_listener","onclick_selectall","checked","dataset","text","deselectall","wordtext","closest","innerHTML","this","querySelectorAll","CHECKBOX_SELECTOR","forEach","cb","set_wordlistaction","wordlistaction","ACTION_SELECTOR","set_wordlistbutton","count","removeAttribute","setAttribute","wordlistbutton","BUTTON_SELECTOR","getAttribute","selectedIndex"],"mappings":";;;;;;;;AAwBAA,iCAAO,IAAI,eAEHC,GAAK,CAETA,mBAAwB,4CACxBA,kBAAuB,mEACvBA,gBAAqB,0CACrBA,gBAAqB,sDAErBA,mBAAwB,SAASC,IAAKC,IAAKC,GAAIC,YACvCH,IAAII,iBACJJ,IAAII,iBAAiBH,IAAKC,GAAKC,aAAc,GACtCH,IAAIK,aACXL,IAAIK,YAAY,KAAOJ,IAAKC,KAOpCH,KAAU,WACNA,GAAGO,kBACHP,GAAGQ,mBACHR,GAAGS,wBAMPT,gBAAqB,iBAEXU,UAAYC,SAASC,cAAcZ,GAAGa,oBACxCH,YACAV,GAAGc,uBAAuBJ,WAC1BV,GAAGe,mBAAmBL,UAAW,QAASV,GAAGgB,qBAOrDhB,uBAA4B,SAASU,iBAC3BO,QAAUP,UAAUO,QACpBC,QAAUR,UAAUQ,QACpBC,KAAQF,QAAUC,QAAQE,YAAcF,QAAQR,UAChDW,SAAWX,UAAUY,QAAQ,SAASV,cAAc,aACtDS,WACAA,SAASE,UAAYJ,OAO7BnB,kBAAuB,iBACbU,UAAYc,KAClBxB,GAAGc,uBAAuBJ,WAC1BC,SAASc,iBAAiBzB,GAAG0B,mBAAmBC,SAAQ,SAASC,IAC7DA,GAAGX,QAAUP,UAAUO,WAE3BjB,GAAG6B,sBAMP7B,iBAAsB,WAClBW,SAASc,iBAAiBzB,GAAG0B,mBAAmBC,SAAQ,SAASC,IAC7D5B,GAAGe,mBAAmBa,GAAI,QAAS5B,GAAG6B,wBAO9C7B,qBAA0B,iBAChB8B,eAAiBnB,SAASC,cAAcZ,GAAG+B,iBAC7CD,iBACA9B,GAAGe,mBAAmBe,eAAgB,SAAU9B,GAAGgC,oBACnDhC,GAAG6B,uBAOX7B,mBAAwB,eAChBiC,MAAQ,EACZtB,SAASc,iBAAiBzB,GAAG0B,mBAAmBC,SAAQ,SAASC,IACzDA,GAAGX,SACHgB,iBAGFH,eAAiBnB,SAASC,cAAcZ,GAAG+B,iBAC7CD,iBACIG,MACAH,eAAeI,gBAAgB,YAE/BJ,eAAeK,aAAa,WAAY,YAE5CnC,GAAGgC,uBAOXhC,mBAAwB,iBACd8B,eAAiBnB,SAASC,cAAcZ,GAAG+B,iBAC3CK,eAAiBzB,SAASC,cAAcZ,GAAGqC,iBAC7CP,gBAAkBM,iBACdN,eAAeQ,aAAa,aAAeR,eAAeS,cAAgB,EAC1EH,eAAeD,aAAa,WAAY,YAExCC,eAAeF,gBAAgB,sBAKpClC"}